<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>src/mummy</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  if (toggleSwitch !== null) {
    toggleSwitch.addEventListener('change', switchTheme, false);
  }

  var currentTheme = localStorage.getItem('theme');
  if (!currentTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    currentTheme = 'dark';
  }
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark' && toggleSwitch !== null) {
      toggleSwitch.checked = true;
    }
  }
}

window.addEventListener('DOMContentLoaded', main);
</script>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">src/mummy</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
    <li>
      <a href="theindex.html">Index</a>
    </li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  <div>
    Group by:
    <select onchange="groupBy(this.value)">
      <option value="section">Section</option>
      <option value="type">Type</option>
    </select>
  </div>
  <ul class="simple simple-toc" id="toc-list">
<li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#Message"
    title="Message = object
  kind*: MessageKind
  data*: string">Message</a></li>
  <li><a class="reference" href="#MessageKind"
    title="MessageKind = enum
  TextMessage, BinaryMessage, Ping, Pong">MessageKind</a></li>
  <li><a class="reference" href="#Request"
    title="Request = ptr RequestObj">Request</a></li>
  <li><a class="reference" href="#RequestHandler"
    title="RequestHandler = proc (request: Request) {.gcsafe.}">RequestHandler</a></li>
  <li><a class="reference" href="#RequestObj"
    title="RequestObj = object
  httpVersion*: HttpVersion
  httpMethod*: string
  uri*: string
  headers*: HttpHeaders
  body*: string
  remoteAddress*: string
  server: Server
  clientSocket: SocketHandle
  clientId: uint64
  responded: bool">RequestObj</a></li>
  <li><a class="reference" href="#Server"
    title="Server = ptr ServerObj">Server</a></li>
  <li><a class="reference" href="#WebSocket"
    title="WebSocket = object
  server: Server
  clientSocket: SocketHandle
  clientId: uint64">WebSocket</a></li>
  <li><a class="reference" href="#WebSocketEvent"
    title="WebSocketEvent = enum
  OpenEvent, MessageEvent, ErrorEvent, CloseEvent">WebSocketEvent</a></li>
  <li><a class="reference" href="#WebSocketHandler"
    title="WebSocketHandler = proc (websocket: WebSocket; event: WebSocketEvent;
                         message: Message) {.gcsafe.}">WebSocketHandler</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">$
      <li><a class="reference" href="#%24%2CRequest"
    title="`$`(request: Request): string">`$`(request: Request): string</a></li>
  <li><a class="reference" href="#%24%2CWebSocket"
    title="`$`(websocket: WebSocket): string">`$`(websocket: WebSocket): string</a></li>

  </ul>
  <ul class="simple nested-toc-section">close
      <li><a class="reference" href="#close%2CServer"
    title="close(server: Server)">close(server: Server)</a></li>
  <li><a class="reference" href="#close%2CWebSocket"
    title="close(websocket: WebSocket)">close(websocket: WebSocket)</a></li>

  </ul>
  <ul class="simple nested-toc-section">newServer
      <li><a class="reference" href="#newServer%2CRequestHandler%2CWebSocketHandler%2CLogHandler"
    title="newServer(handler: RequestHandler; websocketHandler: WebSocketHandler = nil;
          logHandler: LogHandler = nil;
          workerThreads = max(countProcessors() * 10, 1);
          maxHeadersLen = 8 * 1024; maxBodyLen = 1024 * 1024;
          maxMessageLen = 64 * 1024): Server">newServer(handler: RequestHandler; websocketHandler: WebSocketHandler = nil;
          logHandler: LogHandler = nil;
          workerThreads = max(countProcessors() * 10, 1);
          maxHeadersLen = 8 * 1024; maxBodyLen = 1024 * 1024;
          maxMessageLen = 64 * 1024): Server</a></li>

  </ul>
  <ul class="simple nested-toc-section">respond
      <li><a class="reference" href="#respond%2CRequest%2Cint%2CsinkHttpHeaders%2Csinkstring"
    title="respond(request: Request; statusCode: int;
        headers: sink HttpHeaders = emptyHttpHeaders(); body: sink string = &quot;&quot;)">respond(request: Request; statusCode: int;
        headers: sink HttpHeaders = emptyHttpHeaders(); body: sink string = &quot;&quot;)</a></li>

  </ul>
  <ul class="simple nested-toc-section">responded
      <li><a class="reference" href="#responded%2CRequest"
    title="responded(request: Request): bool">responded(request: Request): bool</a></li>

  </ul>
  <ul class="simple nested-toc-section">send
      <li><a class="reference" href="#send%2CWebSocket%2Csinkstring"
    title="send(websocket: WebSocket; data: sink string; kind = TextMessage)">send(websocket: WebSocket; data: sink string; kind = TextMessage)</a></li>

  </ul>
  <ul class="simple nested-toc-section">serve
      <li><a class="reference" href="#serve%2CServer%2CPort%2Cstring"
    title="serve(server: Server; port: Port; address = &quot;localhost&quot;)">serve(server: Server; port: Port; address = &quot;localhost&quot;)</a></li>

  </ul>
  <ul class="simple nested-toc-section">upgradeToWebSocket
      <li><a class="reference" href="#upgradeToWebSocket%2CRequest"
    title="upgradeToWebSocket(request: Request): WebSocket">upgradeToWebSocket(request: Request): WebSocket</a></li>

  </ul>
  <ul class="simple nested-toc-section">waitUntilReady
      <li><a class="reference" href="#waitUntilReady%2CServer%2Cfloat"
    title="waitUntilReady(server: Server; timeout: float = 10)">waitUntilReady(server: Server; timeout: float = 10)</a></li>

  </ul>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#19" id="69">Exports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>

</ul>

  </div>
  &nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1" class="link-seesrc" target="_blank" >Edit</a>

  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc"></p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="mummy/common.html">mummy/common</a>, <a class="reference external" href="mummy/internal.html">mummy/internal</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<div id="Message">
<dt><pre><a href="mummy.html#Message"><span class="Identifier">Message</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">kind</span><span class="Operator">*</span><span class="Other">:</span> <a href="mummy.html#MessageKind"><span class="Identifier">MessageKind</span></a>
  <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L55"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L55" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="MessageKind">
<dt><pre><a href="mummy.html#MessageKind"><span class="Identifier">MessageKind</span></a> <span class="Other">=</span> <span class="Keyword">enum</span>
  <span class="Identifier">TextMessage</span><span class="Other">,</span> <span class="Identifier">BinaryMessage</span><span class="Other">,</span> <span class="Identifier">Ping</span><span class="Other">,</span> <span class="Identifier">Pong</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L62"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L62" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="Request">
<dt><pre><a href="mummy.html#Request"><span class="Identifier">Request</span></a> <span class="Other">=</span> <span class="Keyword">ptr</span> <a href="mummy.html#RequestObj"><span class="Identifier">RequestObj</span></a></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L48"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L48" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="RequestHandler">
<dt><pre><a href="mummy.html#RequestHandler"><span class="Identifier">RequestHandler</span></a> <span class="Other">=</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">request</span><span class="Other">:</span> <a href="mummy.html#Request"><span class="Identifier">Request</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">gcsafe</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L65"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L65" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="RequestObj">
<dt><pre><a href="mummy.html#RequestObj"><span class="Identifier">RequestObj</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">httpVersion</span><span class="Operator">*</span><span class="Other">:</span> <a href="mummy/common.html#HttpVersion"><span class="Identifier">HttpVersion</span></a>
  <span class="Identifier">httpMethod</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">uri</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">headers</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">HttpHeaders</span>
  <span class="Identifier">body</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">remoteAddress</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">server</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a>
  <span class="Identifier">clientSocket</span><span class="Other">:</span> <span class="Identifier">SocketHandle</span>
  <span class="Identifier">clientId</span><span class="Other">:</span> <span class="Identifier">uint64</span>
  <span class="Identifier">responded</span><span class="Other">:</span> <span class="Identifier">bool</span>
</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L36"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L36" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="Server">
<dt><pre><a href="mummy.html#Server"><span class="Identifier">Server</span></a> <span class="Other">=</span> <span class="Keyword">ptr</span> <span class="Identifier">ServerObj</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L97"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L97" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="WebSocket">
<dt><pre><a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">server</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a>
  <span class="Identifier">clientSocket</span><span class="Other">:</span> <span class="Identifier">SocketHandle</span>
  <span class="Identifier">clientId</span><span class="Other">:</span> <span class="Identifier">uint64</span>
</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L50"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L50" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="WebSocketEvent">
<dt><pre><a href="mummy.html#WebSocketEvent"><span class="Identifier">WebSocketEvent</span></a> <span class="Other">=</span> <span class="Keyword">enum</span>
  <span class="Identifier">OpenEvent</span><span class="Other">,</span> <span class="Identifier">MessageEvent</span><span class="Other">,</span> <span class="Identifier">ErrorEvent</span><span class="Other">,</span> <span class="Identifier">CloseEvent</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L59"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L59" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="WebSocketHandler">
<dt><pre><a href="mummy.html#WebSocketHandler"><span class="Identifier">WebSocketHandler</span></a> <span class="Other">=</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">websocket</span><span class="Other">:</span> <a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a><span class="Other">;</span> <span class="Identifier">event</span><span class="Other">:</span> <a href="mummy.html#WebSocketEvent"><span class="Identifier">WebSocketEvent</span></a><span class="Other">;</span>
                         <span class="Identifier">message</span><span class="Other">:</span> <a href="mummy.html#Message"><span class="Identifier">Message</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">gcsafe</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L67"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L67" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<div id="$,Request">
<dt><pre><span class="Keyword">proc</span> <a href="#%24%2CRequest"><span class="Identifier">`$`</span></a><span class="Other">(</span><span class="Identifier">request</span><span class="Other">:</span> <a href="mummy.html#Request"><span class="Identifier">Request</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L150"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L150" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="$,WebSocket">
<dt><pre><span class="Keyword">proc</span> <a href="#%24%2CWebSocket"><span class="Identifier">`$`</span></a><span class="Other">(</span><span class="Identifier">websocket</span><span class="Other">:</span> <a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L159"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L159" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="close,Server">
<dt><pre><span class="Keyword">proc</span> <a href="#close%2CServer"><span class="Identifier">close</span></a><span class="Other">(</span><span class="Identifier">server</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Cleanly stops and deallocates the server. In-flight request handler calls will be allowed to finish. No additional handler calls will be dispatched even if they are queued.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1349"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1349" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="close,WebSocket">
<dt><pre><span class="Keyword">proc</span> <a href="#close%2CWebSocket"><span class="Identifier">close</span></a><span class="Other">(</span><span class="Identifier">websocket</span><span class="Other">:</span> <a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Begins the WebSocket closing handshake. This does not discard previously queued messages before starting the closing handshake. The handshake will only begin after the queued messages are sent.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L271"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L271" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="newServer,RequestHandler,WebSocketHandler,LogHandler">
<dt><pre><span class="Keyword">proc</span> <a href="#newServer%2CRequestHandler%2CWebSocketHandler%2CLogHandler"><span class="Identifier">newServer</span></a><span class="Other">(</span><span class="Identifier">handler</span><span class="Other">:</span> <a href="mummy.html#RequestHandler"><span class="Identifier">RequestHandler</span></a><span class="Other">;</span>
               <span class="Identifier">websocketHandler</span><span class="Other">:</span> <a href="mummy.html#WebSocketHandler"><span class="Identifier">WebSocketHandler</span></a> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span>
               <span class="Identifier">logHandler</span><span class="Other">:</span> <a href="mummy/common.html#LogHandler"><span class="Identifier">LogHandler</span></a> <span class="Other">=</span> <span class="Keyword">nil</span><span class="Other">;</span>
               <span class="Identifier">workerThreads</span> <span class="Other">=</span> <span class="Identifier">max</span><span class="Other">(</span><span class="Identifier">countProcessors</span><span class="Other">(</span><span class="Other">)</span> <span class="Operator">*</span> <span class="DecNumber">10</span><span class="Other">,</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">;</span>
               <span class="Identifier">maxHeadersLen</span> <span class="Other">=</span> <span class="DecNumber">8</span> <span class="Operator">*</span> <span class="DecNumber">1024</span><span class="Other">;</span> <span class="Identifier">maxBodyLen</span> <span class="Other">=</span> <span class="DecNumber">1024</span> <span class="Operator">*</span> <span class="DecNumber">1024</span><span class="Other">;</span>
               <span class="Identifier">maxMessageLen</span> <span class="Other">=</span> <span class="DecNumber">64</span> <span class="Operator">*</span> <span class="DecNumber">1024</span><span class="Other">)</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><a href="mummy/common.html#MummyError"><span class="Identifier">MummyError</span></a><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">,</span> <span class="Identifier">WriteIOEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Creates a new HTTP server. The request handler will be called for incoming HTTP requests. The WebSocket handler will be called for WebSocket events. Calls to the HTTP, WebSocket and log handlers are made from worker threads. WebSocket events are dispatched serially per connection. This means your WebSocket handler must return from a call before the next call will be dispatched for the same connection.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1417"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1417" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="respond,Request,int,sinkHttpHeaders,sinkstring">
<dt><pre><span class="Keyword">proc</span> <a href="#respond%2CRequest%2Cint%2CsinkHttpHeaders%2Csinkstring"><span class="Identifier">respond</span></a><span class="Other">(</span><span class="Identifier">request</span><span class="Other">:</span> <a href="mummy.html#Request"><span class="Identifier">Request</span></a><span class="Other">;</span> <span class="Identifier">statusCode</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span>
             <span class="Identifier">headers</span><span class="Other">:</span> <span class="Identifier">sink</span> <span class="Identifier">HttpHeaders</span> <span class="Other">=</span> <span class="Identifier">emptyHttpHeaders</span><span class="Other">(</span><span class="Other">)</span><span class="Other">;</span>
             <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">sink</span> <span class="Identifier">string</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Sends the response for the request. This should usually only be called once per request.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L291"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L291" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="responded,Request">
<dt><pre><span class="Keyword">proc</span> <a href="#responded%2CRequest"><span class="Identifier">responded</span></a><span class="Other">(</span><span class="Identifier">request</span><span class="Other">:</span> <a href="mummy.html#Request"><span class="Identifier">Request</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Check if this request has been responded. Informational responses (1xx status codes) do not mark a request responded.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1480"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1480" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="send,WebSocket,sinkstring">
<dt><pre><span class="Keyword">proc</span> <a href="#send%2CWebSocket%2Csinkstring"><span class="Identifier">send</span></a><span class="Other">(</span><span class="Identifier">websocket</span><span class="Other">:</span> <a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">sink</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">kind</span> <span class="Other">=</span> <span class="Identifier">TextMessage</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Enqueues the message to be sent over the WebSocket connection.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L240"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L240" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="serve,Server,Port,string">
<dt><pre><span class="Keyword">proc</span> <a href="#serve%2CServer%2CPort%2Cstring"><span class="Identifier">serve</span></a><span class="Other">(</span><span class="Identifier">server</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <span class="Identifier">Port</span><span class="Other">;</span> <span class="Identifier">address</span> <span class="Other">=</span> <span class="StringLit">&quot;localhost&quot;</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><a href="mummy/common.html#MummyError"><span class="Identifier">MummyError</span></a><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">WriteIOEffect</span><span class="Other">,</span> <span class="Identifier">ReadIOEffect</span><span class="Other">,</span> <span class="Identifier">RootEffect</span><span class="Other">,</span> <span class="Identifier">TimeEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

The server will serve on the address and port. The default address is localhost. Use &quot;0.0.0.0&quot; to make the server externally accessible (with caution). This call does not return unless server.close() is called from another thread.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1358"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1358" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="upgradeToWebSocket,Request">
<dt><pre><span class="Keyword">proc</span> <a href="#upgradeToWebSocket%2CRequest"><span class="Identifier">upgradeToWebSocket</span></a><span class="Other">(</span><span class="Identifier">request</span><span class="Other">:</span> <a href="mummy.html#Request"><span class="Identifier">Request</span></a><span class="Other">)</span><span class="Other">:</span> <a href="mummy.html#WebSocket"><span class="Identifier">WebSocket</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><a href="mummy/common.html#MummyError"><span class="Identifier">MummyError</span></a><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">gcsafe</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

Upgrades the request to a WebSocket connection. You can immediately start calling send().
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L390"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L390" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="waitUntilReady,Server,float">
<dt><pre><span class="Keyword">proc</span> <a href="#waitUntilReady%2CServer%2Cfloat"><span class="Identifier">waitUntilReady</span></a><span class="Other">(</span><span class="Identifier">server</span><span class="Other">:</span> <a href="mummy.html#Server"><span class="Identifier">Server</span></a><span class="Other">;</span> <span class="Identifier">timeout</span><span class="Other">:</span> <span class="Identifier">float</span> <span class="Other">=</span> <span class="DecNumber">10</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MummyError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">TimeEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

This proc blocks until the server is ready to receive requests or the timeout has passed. The timeout is in floating point seconds. This is useful when writing tests, where you need to know the server is ready before you begin sending requests. If the server is already ready this returns immediately.
&nbsp;&nbsp;<a
href="https://github.com/guzba/mummy/tree/master/src/mummy.nim#L1486"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/guzba/mummy/edit/devel/src/mummy.nim#L1486" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="19">
<h1><a class="toc-backref" href="#19">Exports</a></h1>
<dl class="item">
<a href="mummy/common.html#HttpVersion"><span class="Identifier">HttpVersion</span></a>, <a href="mummy/common.html#LogLevel"><span class="Identifier">LogLevel</span></a>, <a href="mummy/common.html#MummyError"><span class="Identifier">MummyError</span></a>, <a href="mummy/common.html#echoLogger,LogLevel,varargs[string]"><span class="Identifier">echoLogger</span></a>, <a href="mummy/common.html#LogHandler"><span class="Identifier">LogHandler</span></a>
</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2023-06-13 18:49:24 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
